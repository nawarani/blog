<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Plotting ROC curve in Altair</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://nawarani.github.io/blog/blog-2.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://nawarani.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Anika's blog Full Atom Feed" />
          <link href="https://nawarani.github.io/blog/feeds/{'slug': u'misc'}.atom.xml" type="application/atom+xml" rel="alternate" title="Anika's blog Categories Atom Feed" />

  <link href="https://nawarani.github.io/blog/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://nawarani.github.io/blog/theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="So you can make an ROC curve in pyplot but it looks like this. But fear not my friends, for Altair is here to fulfill all your aesthetic...">

    <meta name="author" content="Anika Nawar">





<!-- Open Graph -->
<meta property="og:site_name" content="Anika's blog"/>
<meta property="og:title" content="Plotting ROC curve in Altair"/>
<meta property="og:description" content="So you can make an ROC curve in pyplot but it looks like this. But fear not my friends, for Altair is here to fulfill all your aesthetic..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://nawarani.github.io/blog/blog-2.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-09-30 00:00:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://nawarani.github.io/blog/author/anika-nawar.html">
<meta property="article:section" content="misc"/>
<meta property="og:image" content="https://images.unsplash.com/photo-1543286386-713bdd548da4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@anikanaw">
    <meta name="twitter:title" content="Plotting ROC curve in Altair">
    <meta name="twitter:url" content="https://nawarani.github.io/blog/blog-2.html">

        <meta name="twitter:image:src" content="https://images.unsplash.com/photo-1543286386-713bdd548da4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80">

      <meta name="twitter:description" content="So you can make an ROC curve in pyplot but it looks like this. But fear not my friends, for Altair is here to fulfill all your aesthetic...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Plotting ROC curve in Altair",
  "headline": "Plotting ROC curve in Altair",
  "datePublished": "2019-09-30 00:00:00-04:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Anika Nawar",
    "url": "https://nawarani.github.io/blog/author/anika-nawar.html"
  },
  "image": "https://images.unsplash.com/photo-1543286386-713bdd548da4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80",
  "url": "https://nawarani.github.io/blog/blog-2.html",
  "description": "So you can make an ROC curve in pyplot but it looks like this. But fear not my friends, for Altair is here to fulfill all your aesthetic..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://nawarani.github.io/blog/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Plotting ROC curve in Altair</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://nawarani.github.io/blog/author/anika-nawar.html">Anika Nawar</a>
            | <time datetime="Mon 30 September 2019">Mon 30 September 2019</time>
        </span>
        <!-- TODO : Modified check -->
            <div class="post-cover cover" style="background-image: url('https://images.unsplash.com/photo-1543286386-713bdd548da4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>So you can make an ROC curve in pyplot but it looks like this.</p>
<p><img src = "https://i.imgur.com/3pEIjFt.png" width = 750></p>
<p>But fear not my friends, for Altair is here to fulfill all your aesthetic needs. In this amazing* blog I will introduce the ways of plotting an ROC curve in Altair.</p>
<p>In an ideal world, there will be an ROC curve in the <a href="https://altair-viz.github.io/gallery/index.html">Altair example gallery</a>, but the path to an ROC curve is harder than we wish for it to be.</p>
<p>(Condition may apply)</p>
<p>ROC curve plots Sensitivity(True positive rate) and 1 - Specifity(False positive rate) on it's x and y axis. Before we get that, we need to first create a model. If you wish to skip all of that and get to the ROC curve, you can do that <a href="#ROC">here</a>.</p>
<p>For this example, I am using titanic data from <a href="https://www.kaggle.com/c/titanic">Kaggle</a></p>
<div class="highlight"><pre><span></span><span class="c1"># imports</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn_pandas</span> <span class="kn">import</span> <span class="n">CategoricalImputer</span>
<span class="kn">from</span> <span class="nn">sklearn_pandas</span> <span class="kn">import</span> <span class="n">DataFrameMapper</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span><span class="p">,</span> <span class="n">RandomForestClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">label_binarize</span><span class="p">,</span> <span class="n">LabelBinarizer</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span>

<span class="k">class</span> <span class="nc">SafeLabelBinarizer</span><span class="p">(</span><span class="n">TransformerMixin</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lb</span> <span class="o">=</span> <span class="n">LabelBinarizer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lb</span><span class="o">.</span><span class="n">classes_</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;__FAKE__&#39;</span><span class="p">])</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">label_binarize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">neg_label</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># in this house we mute our warnings</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>


<h2>Step 1: Load data</h2>
<p>Load data, drop na, impute values(Preferebly after you train test split).</p>
<div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/train.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># drop na</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Embarked&#39;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Dataframer to impute missing values, standard scale and label binarize</span>
<span class="n">mapper</span> <span class="o">=</span> <span class="n">DataFrameMapper</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="n">SafeLabelBinarizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">LabelEncoder</span><span class="p">()),</span>
    <span class="p">([</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span> <span class="n">StandardScaler</span><span class="p">()]),</span>
    <span class="p">(</span><span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Parch&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
    <span class="p">([</span><span class="s1">&#39;Fare&#39;</span><span class="p">],</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;Embarked&#39;</span><span class="p">,</span> <span class="n">SafeLabelBinarizer</span><span class="p">())</span>
<span class="p">],</span> <span class="n">df_out</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Z_df</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>


<h2>Step 2: Train test split</h2>
<div class="highlight"><pre><span></span><span class="c1"># train test split</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;Survived&#39;</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">Z_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Z_df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
<span class="n">Z_train</span><span class="p">,</span> <span class="n">Z_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>


<h2>Step 3: Feature Selection</h2>
<div class="highlight"><pre><span></span><span class="c1"># feature selection using ANOVA</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectPercentile</span>

<span class="n">select</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">percentile</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">select</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">Z_train_selected</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z_train</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># find selected features and put it in a column</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="n">select_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Z_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">selection</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">])</span>
<span class="n">select_df</span><span class="p">[</span><span class="n">select_df</span><span class="p">[</span><span class="s1">&#39;bool&#39;</span><span class="p">]]</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>bool</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Sex</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Fare</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1"># scatter plot to see how our data is looking</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="kn">as</span> <span class="nn">alt</span>
<span class="n">alt</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>

<span class="c1"># disable max rows</span>
<span class="n">alt</span><span class="o">.</span><span class="n">data_transformers</span><span class="o">.</span><span class="n">disable_max_rows</span><span class="p">()</span>


<span class="c1"># put y_train in the same df as X_train</span>
<span class="n">scatter_df</span> <span class="o">=</span> <span class="n">Z_train</span><span class="p">[[</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span><span class="p">]]</span>
<span class="n">scatter_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>


<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">scatter_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">fillOpacity</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">])),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;y:N&#39;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;vega.vegalite.VegaLite at 0x7f364d5f0eb8&gt;
</pre></div>


<p><img alt="png" src="images/output_14_2.png"></p>
<h2>Step 4: Model</h2>
<p>What models can we try on this?
- knn
- logreg
- svm
- random forest
- bag</p>
<p>Let's try out all of them!</p>
<p>In the next block of code, I am going to set up a loop to fit these models and put their scores in a df for easier interpretation.</p>
<div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span> <span class="o">=</span> <span class="s1">&#39;scale&#39;</span><span class="p">)</span>
<span class="n">ada</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">()</span>
<span class="n">bag</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">()</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">knn</span><span class="p">,</span> <span class="n">logreg</span><span class="p">,</span> <span class="n">svc</span><span class="p">,</span> <span class="n">ada</span><span class="p">,</span> <span class="n">bag</span><span class="p">]</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="s1">&#39;ada&#39;</span><span class="p">,</span> <span class="s1">&#39;bag&#39;</span><span class="p">]</span>
<span class="n">model_score_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">model_no</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">model_tscore</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">model_pscore</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_score_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="n">model_names</span><span class="p">[</span><span class="n">model_no</span><span class="p">]</span> <span class="p">:</span> <span class="p">[</span><span class="n">model_tscore</span><span class="p">,</span> <span class="n">model_pscore</span><span class="p">]})</span>
    <span class="n">model_no</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">model_score_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model_score_dict</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">model_score_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train_score&#39;</span><span class="p">,</span> <span class="s1">&#39;test_score&#39;</span><span class="p">]</span>
<span class="n">model_score_df</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train_score</th>
      <th>test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>knn</th>
      <td>0.828829</td>
      <td>0.789238</td>
    </tr>
    <tr>
      <th>logreg</th>
      <td>0.788288</td>
      <td>0.802691</td>
    </tr>
    <tr>
      <th>svc</th>
      <td>0.831832</td>
      <td>0.820628</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>0.833333</td>
      <td>0.811659</td>
    </tr>
    <tr>
      <th>bag</th>
      <td>0.966967</td>
      <td>0.820628</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let's call a confusion matrix to identify our false positive and false negatives.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fn</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z_train</span><span class="p">))</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">fn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model_score_df</span><span class="p">[</span><span class="s1">&#39;False positive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fp</span>
<span class="n">model_score_df</span><span class="p">[</span><span class="s1">&#39;False negative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span>
<span class="n">model_score_df</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train_score</th>
      <th>test_score</th>
      <th>False positive</th>
      <th>False negative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>knn</th>
      <td>0.828829</td>
      <td>0.789238</td>
      <td>38</td>
      <td>76</td>
    </tr>
    <tr>
      <th>logreg</th>
      <td>0.788288</td>
      <td>0.802691</td>
      <td>54</td>
      <td>87</td>
    </tr>
    <tr>
      <th>svc</th>
      <td>0.831832</td>
      <td>0.820628</td>
      <td>39</td>
      <td>73</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>0.833333</td>
      <td>0.811659</td>
      <td>53</td>
      <td>58</td>
    </tr>
    <tr>
      <th>bag</th>
      <td>0.966967</td>
      <td>0.820628</td>
      <td>7</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>

<p>At this point I will pick one model based of root mean squared errors since I don't want 5 different models. We want to minimize False positives, since it is predicting people to survive titanic falsely.</p>
<div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">rmse_train</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rmse_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">rmse_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z_train</span><span class="p">))))</span>
    <span class="n">rmse_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z_test</span><span class="p">))))</span>
<span class="n">model_score_df</span><span class="p">[</span><span class="s1">&#39;rmse train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmse_train</span>
<span class="n">model_score_df</span><span class="p">[</span><span class="s1">&#39;rmse test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmse_test</span>
<span class="n">model_score_df</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train_score</th>
      <th>test_score</th>
      <th>False positive</th>
      <th>False negative</th>
      <th>rmse train</th>
      <th>rmse test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>knn</th>
      <td>0.828829</td>
      <td>0.789238</td>
      <td>38</td>
      <td>76</td>
      <td>0.413728</td>
      <td>0.459089</td>
    </tr>
    <tr>
      <th>logreg</th>
      <td>0.788288</td>
      <td>0.802691</td>
      <td>54</td>
      <td>87</td>
      <td>0.460121</td>
      <td>0.444195</td>
    </tr>
    <tr>
      <th>svc</th>
      <td>0.831832</td>
      <td>0.820628</td>
      <td>39</td>
      <td>73</td>
      <td>0.410083</td>
      <td>0.423524</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>0.833333</td>
      <td>0.811659</td>
      <td>53</td>
      <td>58</td>
      <td>0.408248</td>
      <td>0.433982</td>
    </tr>
    <tr>
      <th>bag</th>
      <td>0.966967</td>
      <td>0.820628</td>
      <td>7</td>
      <td>15</td>
      <td>0.181750</td>
      <td>0.423524</td>
    </tr>
  </tbody>
</table>
</div>

<p>Looking at the root mean squared error we can see that bag is massively overfitting. Among the others, since logreg has low number of false positives and not overfitting, I will be working with the logreg model going forward.</p>
<h2>Step 6: ROC curve</h2>
<p><span id = "ROC">First, import roc_curve from sklearn.metrics</span></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>
</pre></div>


<p>If we try using the roc_curve, we get a tuple of three arrays.</p>
<div class="highlight"><pre><span></span><span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Z_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>(array([0.        , 0.        , 0.        , 0.0070922 , 0.0070922 ,
        0.0141844 , 0.0141844 , 0.0212766 , 0.0212766 , 0.02836879,
        0.02836879, 0.03546099, 0.03546099, 0.04255319, 0.04255319,
        0.05673759, 0.05673759, 0.06382979, 0.07092199, 0.07092199,
        0.07801418, 0.07801418, 0.08510638, 0.08510638, 0.09929078,
        0.09929078, 0.09929078, 0.12056738, 0.12056738, 0.13475177,
        0.13475177, 0.15602837, 0.15602837, 0.16312057, 0.16312057,
        0.19148936, 0.20567376, 0.21276596, 0.21276596, 0.23404255,
        0.23404255, 0.27659574, 0.27659574, 0.29078014, 0.29078014,
        0.38297872, 0.38297872, 0.39716312, 0.42553191, 0.42553191,
        0.45390071, 0.46808511, 0.46808511, 0.53191489, 0.53191489,
        0.54609929, 0.54609929, 0.58865248, 0.64539007, 0.66666667,
        0.66666667, 0.67375887, 0.67375887, 0.70212766, 0.70921986,
        0.72340426, 0.73758865, 0.75886525, 0.75886525, 0.78014184,
        0.79432624, 0.80141844, 0.80141844, 0.82978723, 0.82978723,
        0.95744681, 0.95744681, 0.9787234 , 0.9787234 , 0.9929078 ,
        0.9929078 , 1.        ]),
 array([0.        , 0.01219512, 0.09756098, 0.09756098, 0.14634146,
        0.14634146, 0.23170732, 0.23170732, 0.25609756, 0.25609756,
        0.26829268, 0.26829268, 0.34146341, 0.34146341, 0.35365854,
        0.35365854, 0.36585366, 0.36585366, 0.37804878, 0.40243902,
        0.40243902, 0.54878049, 0.54878049, 0.56097561, 0.56097561,
        0.64634146, 0.67073171, 0.67073171, 0.69512195, 0.69512195,
        0.70731707, 0.70731707, 0.7195122 , 0.7195122 , 0.74390244,
        0.74390244, 0.74390244, 0.74390244, 0.76829268, 0.76829268,
        0.79268293, 0.79268293, 0.80487805, 0.80487805, 0.82926829,
        0.82926829, 0.84146341, 0.84146341, 0.84146341, 0.85365854,
        0.85365854, 0.85365854, 0.86585366, 0.86585366, 0.87804878,
        0.87804878, 0.8902439 , 0.8902439 , 0.8902439 , 0.8902439 ,
        0.90243902, 0.90243902, 0.91463415, 0.91463415, 0.92682927,
        0.92682927, 0.92682927, 0.92682927, 0.93902439, 0.93902439,
        0.93902439, 0.93902439, 0.95121951, 0.95121951, 0.96341463,
        0.96341463, 0.97560976, 0.97560976, 0.98780488, 0.98780488,
        1.        , 1.        ]),
 array([1.99744172, 0.99744172, 0.94802736, 0.94474722, 0.91216806,
        0.91016584, 0.86291933, 0.8382966 , 0.83372469, 0.82875635,
        0.82690869, 0.82192273, 0.79683702, 0.79446157, 0.79247748,
        0.7860147 , 0.78141029, 0.78084334, 0.78059048, 0.77416638,
        0.76790089, 0.74559848, 0.74501473, 0.74385814, 0.73474122,
        0.69480795, 0.69469723, 0.67220763, 0.64737263, 0.61426159,
        0.56103306, 0.45388116, 0.44597977, 0.44026677, 0.433414  ,
        0.34722463, 0.34089803, 0.32391737, 0.31055878, 0.29973214,
        0.29913852, 0.27632818, 0.27176651, 0.26021998, 0.24215657,
        0.21684026, 0.21660699, 0.21365709, 0.21063635, 0.21053544,
        0.20480123, 0.2041879 , 0.20348405, 0.1911644 , 0.1893214 ,
        0.18762464, 0.18574177, 0.18048163, 0.17869446, 0.17737869,
        0.17487844, 0.17460838, 0.17426327, 0.1718786 , 0.17101333,
        0.16646745, 0.16312625, 0.15990887, 0.15114827, 0.14643356,
        0.14520526, 0.14516206, 0.14446441, 0.13541606, 0.13341571,
        0.09774562, 0.09750801, 0.0885746 , 0.07896153, 0.05861408,
        0.05726617, 0.03608227]))
</pre></div>


<p>To better manage the output, we will tuple unpack it into fpr, tpr and thresholds and create a dataframe with the values</p>
<div class="highlight"><pre><span></span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Z_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">roc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">roc_df</span><span class="p">[</span><span class="s1">&#39;fpr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpr</span>
<span class="n">roc_df</span><span class="p">[</span><span class="s1">&#39;tpr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tpr</span>
<span class="n">roc_df</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thresholds</span>
<span class="n">roc_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fpr</th>
      <th>tpr</th>
      <th>thresholds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.997442</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000000</td>
      <td>0.012195</td>
      <td>0.997442</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000</td>
      <td>0.097561</td>
      <td>0.948027</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.007092</td>
      <td>0.097561</td>
      <td>0.944747</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.007092</td>
      <td>0.146341</td>
      <td>0.912168</td>
    </tr>
  </tbody>
</table>
</div>

<p>It is finally time for us to plot the ROC curve. The three plots can be created in any order, but it is important that they are stored in a variable and called at the end in order. I have mentioned the baseline last so that it is not masked by the area plot.</p>
<h4>Plot ROC curve</h4>
<div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;false positive rate&quot;</span><span class="p">),</span>
                                                <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;true positive rate&quot;</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;vega.vegalite.VegaLite at 0x7f364d076f60&gt;
</pre></div>


<p><img alt="png" src="images/output_32_2.png"></p>
<div class="highlight"><pre><span></span><span class="n">roc_line</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;false positive rate&quot;</span><span class="p">),</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;true positive rate&quot;</span><span class="p">))</span>
</pre></div>


<h4>Plot Area under the curve, AUC</h4>
<div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">fillOpacity</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                                    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;false positive rate&quot;</span><span class="p">),</span>
                                                                    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;true positive rate&quot;</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;vega.vegalite.VegaLite at 0x7f3648feda58&gt;
</pre></div>


<p><img alt="png" src="images/output_35_2.png"></p>
<div class="highlight"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">fillOpacity</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                                    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;fpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;false positive rate&quot;</span><span class="p">),</span>
                                                                    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;tpr&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;true positive rate&quot;</span><span class="p">))</span>
</pre></div>


<h4>Plot baseline(Perfect overlap between the two populations.)</h4>
<div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeDash</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;vega.vegalite.VegaLite at 0x7f3648fed710&gt;
</pre></div>


<p><img alt="png" src="images/output_38_2.png"></p>
<div class="highlight"><pre><span></span><span class="n">baseline</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">roc_df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeDash</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span>
                                                                <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
</pre></div>


<p>Put them all together and you're done!</p>
<div class="highlight"><pre><span></span><span class="n">roc_line</span> <span class="o">+</span> <span class="n">roc</span> <span class="o">+</span> <span class="n">baseline</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Titanic survivor data ROC curve&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;vega.vegalite.VegaLite at 0x7f364d639048&gt;
</pre></div>


<p><img alt="png" src="images/output_41_2.png"></p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Plotting ROC curve in Altair&amp;url=https://nawarani.github.io/blog/blog-2.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://nawarani.github.io/blog/blog-2.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://nawarani.github.io/blog/blog-2.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>


                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://nawarani.github.io/blog/theme/js/script.js"></script>

</body>
</html>