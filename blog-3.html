<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Blog 3 - Intro to Naural Language Processing with spaCy</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://nawarani.github.io/blog/blog-3.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://nawarani.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="blog Full Atom Feed" />
          <link href="https://nawarani.github.io/blog/feeds/{'slug': u'misc'}.atom.xml" type="application/atom+xml" rel="alternate" title="blog Categories Atom Feed" />

  <link href="https://nawarani.github.io/blog/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://nawarani.github.io/blog/theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="spaCy spaCy is a natural language processing library for python. Some of its features are: - non-destructive tokenization, - named...">

    <meta name="author" content="Anika Nawar">





<!-- Open Graph -->
<meta property="og:site_name" content="blog"/>
<meta property="og:title" content="Blog 3 - Intro to Naural Language Processing with spaCy"/>
<meta property="og:description" content="spaCy spaCy is a natural language processing library for python. Some of its features are: - non-destructive tokenization, - named..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://nawarani.github.io/blog/blog-3.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-10-07 00:00:00-04:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://nawarani.github.io/blog/author/anika-nawar.html">
<meta property="article:section" content="misc"/>
<meta property="og:image" content="https://nawarani.github.io/blog/static/dennis_kummer_unsplash.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@anikanaw">
    <meta name="twitter:title" content="Blog 3 - Intro to Naural Language Processing with spaCy">
    <meta name="twitter:url" content="https://nawarani.github.io/blog/blog-3.html">

        <meta name="twitter:image:src" content="https://nawarani.github.io/blog/static/dennis_kummer_unsplash.jpg">

      <meta name="twitter:description" content="spaCy spaCy is a natural language processing library for python. Some of its features are: - non-destructive tokenization, - named...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Blog 3 - Intro to Naural Language Processing with spaCy",
  "headline": "Blog 3 - Intro to Naural Language Processing with spaCy",
  "datePublished": "2019-10-07 00:00:00-04:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Anika Nawar",
    "url": "https://nawarani.github.io/blog/author/anika-nawar.html"
  },
  "image": "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1951&q=80",
  "url": "https://nawarani.github.io/blog/blog-3.html",
  "description": "spaCy spaCy is a natural language processing library for python. Some of its features are: - non-destructive tokenization, - named..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://nawarani.github.io/blog/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Blog 3 - Intro to Naural Language Processing with spaCy</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://nawarani.github.io/blog/author/anika-nawar.html">Anika Nawar</a>
            | <time datetime="Mon 07 October 2019">Mon 07 October 2019</time>
        </span>
        <!-- TODO : Modified check -->
            <div class="post-cover cover" style="background-image: url('https://nawarani.github.io/blog/static/dennis_kummer_unsplash.jpg')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <h2>spaCy</h2>
<p>spaCy is a natural language processing library for python. Some of its features are:
- non-destructive tokenization,
- named entity recognition,
- pre-trained models
- support for 52+ individual langueages.</p>
<p>Since coding is best explained through examples, in this blog, we will use spacy to work through a book from <a href="http://www.gutenberg.org/ebooks/1661">Project Gutenberg</a>.</p>
<h3>Finding proper nouns and custom patterns in The Adventures of Sherlock Holmes</h3>
<h4>Install spacy and language model</h4>
<div class="highlight"><pre><span></span><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">spacy</span>
<span class="err">!</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">en_core_web_sm</span>
</pre></div>


<h4>Imports</h4>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>
</pre></div>


<h4>Load model as the nlp onject</h4>
<p>spacy language and models can be downloaded as python packages. Some of the models and langugae packages can be found <a href="https://spacy.io/usage/models">here</a>. For this example, we will be using the small english languge web model 'en_core_web_sm'.</p>
<div class="highlight"><pre><span></span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_sm&#39;</span><span class="p">)</span>
</pre></div>


<h4>Load text</h4>
<div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/1661-0.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>


<p>The length of the text is more than the default max length, so we reassign the max length of text to reflect that.</p>
<div class="highlight"><pre><span></span><span class="n">nlp</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>


<h4>Process text</h4>
<div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>


<h4>Find sentences in text</h4>
<div class="highlight"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">)</span>
</pre></div>


<p>we can access the sentences through a loop.</p>
<div class="highlight"><pre><span></span><span class="n">long_sentences</span> <span class="o">=</span> <span class="p">[</span><span class="n">sentence</span> <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">long_sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>A shock of orange hair, a
pale face disfigured by a horrible scar, which, by its contraction, has
turned up the outer edge of his upper lip, a bulldog chin, and a pair
of very penetrating dark eyes, which present a singular contrast to the
colour of his hair, all mark him out from amid the common crowd of
mendicants and so, too, does his wit, for he is ever ready with a reply
to any piece of chaff which may be thrown at him by the passers-by.
</pre></div>


<h4>Tokenization, Lemmatization and labeling of named entities</h4>
<p>When we call the nlp object on our text, it calls for a pipeline object that tokenizes, tags, parses and recognizes entities. We can access the tokens and entities through a loop, call for the lemmas of each word through .lemma_ and find labels for the entities through .label_</p>
<p><img alt="" src="https://d33wubrfki0l68.cloudfront.net/16b2ccafeefd6d547171afa23f9ac62f159e353d/48b91/pipeline-7a14d4edd18f3edfee8f34393bff2992.svg"></p>
<div class="highlight"><pre><span></span><span class="n">token_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
<span class="n">token_list</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1010</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>[problem, ., I, rang, the, bell, , and, was, shown]
</pre></div>


<div class="highlight"><pre><span></span><span class="n">lemma_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
<span class="n">lemma_list</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1010</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>[&#39;problem&#39;, &#39;.&#39;, &#39;-PRON-&#39;, &#39;ring&#39;, &#39;the&#39;, &#39;bell&#39;, &#39;\n&#39;, &#39;and&#39;, &#39;be&#39;, &#39;show&#39;]
</pre></div>


<div class="highlight"><pre><span></span><span class="n">entity_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">label_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="n">entity_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
    <span class="n">label_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entity_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Gutenberg</span> <span class="o">:</span> <span class="n">PERSON</span>
<span class="n">The</span> <span class="n">Adventures</span> <span class="n">of</span> <span class="n">Sherlock</span> <span class="n">Holmes</span> <span class="o">:</span> <span class="n">WORK_OF_ART</span>
<span class="n">Arthur</span> <span class="n">Conan</span> <span class="n">Doyle</span>

 <span class="o">:</span> <span class="n">ORG</span>
<span class="n">the</span> <span class="n">Project</span> <span class="n">Gutenberg</span> <span class="n">License</span> <span class="o">:</span> <span class="n">ORG</span>
<span class="n">eBook</span> <span class="o">:</span> <span class="n">LAW</span>
<span class="n">The</span> <span class="n">Adventures</span> <span class="n">of</span> <span class="n">Sherlock</span> <span class="n">Holmes</span>

 <span class="o">:</span> <span class="n">WORK_OF_ART</span>
<span class="n">Arthur</span> <span class="n">Conan</span> <span class="n">Doyle</span>

<span class="n">Release</span> <span class="n">Date</span> <span class="o">:</span> <span class="n">PERSON</span>
<span class="n">November</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">2002</span> <span class="o">:</span> <span class="n">DATE</span>
<span class="n">May</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">2019</span> <span class="o">:</span> <span class="n">DATE</span>
<span class="n">English</span> <span class="o">:</span> <span class="n">LANGUAGE</span>
</pre></div>


<p>As we can see, it's not perfect. Often times, for bigger text documents like this it is better to use larger models. 'en_core_web_sm' is a smaller model, as denoted by the 'sm' suffix.</p>
<h4>Find all the proper nouns in the text</h4>
<div class="highlight"><pre><span></span><span class="n">proper_noun_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">pos_</span> <span class="o">==</span> <span class="s1">&#39;PROPN&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of proper nouns in text:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">proper_noun_list</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Example:&#39;</span><span class="p">,</span> <span class="n">proper_noun_list</span><span class="p">[</span><span class="mi">1537</span><span class="p">:</span><span class="mi">1550</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>Number of proper nouns in text: 5070
Example: [&#39;Miss&#39;, &#39;Turner&#39;, &#39;James&#39;, &#39;Mr.&#39;, &#39;Holmes&#39;, &#39;Miss&#39;, &#39;Turner&#39;, &#39;God&#39;, &#39;Holmes&#39;, &#39;Lestrade&#39;, &#39;James&#39;, &#39;McCarthy&#39;, &#39;Holmes&#39;]
</pre></div>


<p>The proper nouns can also be accessed through loops.</p>
<h4>Stop words</h4>
<p>Stop words and punctuations can be targeted through is_stop and is_punct.</p>
<div class="highlight"><pre><span></span><span class="n">clean_doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_stop</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)]</span>
<span class="n">clean_doc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>[&#39;\n&#39;,
 &#39;Project&#39;,
 &#39;Gutenberg&#39;,
 &#39;Adventures&#39;,
 &#39;Sherlock&#39;,
 &#39;Holmes&#39;,
 &#39;Arthur&#39;,
 &#39;Conan&#39;,
 &#39;Doyle&#39;,
 &#39;\n\n&#39;]
</pre></div>


<p>We can use our own stop_words or make a default stop_word not a stop_word with in the following <a href="https://stackoverflow.com/questions/41170726/add-remove-stop-words-with-spacy">process</a>.</p>
<div class="highlight"><pre><span></span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s2">&quot;the&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">is_stop</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">clean_text</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_stop</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)]</span>
<span class="n">clean_text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>[&#39;Project&#39;,
 &#39;Gutenberg&#39;,
 &#39;Adventures&#39;,
 &#39;Sherlock&#39;,
 &#39;Holmes&#39;,
 &#39;Arthur&#39;,
 &#39;Conan&#39;,
 &#39;Doyle&#39;,
 &#39;\n\n&#39;,
 &#39;eBook&#39;]
</pre></div>


<h4>dependencies and visualization through displacy</h4>
<div class="highlight"><pre><span></span><span class="c1"># Print the text and the predicted part-of-speech tag</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Sentence:&#39;</span><span class="p">,</span><span class="n">sentences</span><span class="p">[</span><span class="mi">637</span><span class="p">])</span>
<span class="n">sent_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="s1">&#39;dep&#39;</span><span class="p">,</span> <span class="s1">&#39;related word&#39;</span><span class="p">])</span>
<span class="n">text_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pos_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dep_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rel_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">[</span><span class="mi">637</span><span class="p">]:</span>
    <span class="n">text_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">pos_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">pos_</span><span class="p">)</span>
    <span class="n">dep_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">dep_</span><span class="p">)</span>
    <span class="n">rel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_list</span>
<span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_list</span>
<span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;dep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep_list</span>
<span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;related word&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rel_list</span>
<span class="n">sent_df</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Sentence</span><span class="o">:</span> <span class="n">I</span> <span class="n">wish</span> <span class="n">she</span> <span class="n">had</span> <span class="n">been</span> <span class="n">of</span> <span class="n">my</span> <span class="n">own</span> <span class="n">station</span><span class="o">!</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>pos</th>
      <th>dep</th>
      <th>related word</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>I</td>
      <td>PRON</td>
      <td>nsubj</td>
      <td>wish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>wish</td>
      <td>VERB</td>
      <td>ROOT</td>
      <td>wish</td>
    </tr>
    <tr>
      <th>2</th>
      <td>she</td>
      <td>PRON</td>
      <td>nsubj</td>
      <td>been</td>
    </tr>
    <tr>
      <th>3</th>
      <td>had</td>
      <td>AUX</td>
      <td>aux</td>
      <td>been</td>
    </tr>
    <tr>
      <th>4</th>
      <td>been</td>
      <td>AUX</td>
      <td>ccomp</td>
      <td>wish</td>
    </tr>
    <tr>
      <th>5</th>
      <td>of</td>
      <td>ADP</td>
      <td>prep</td>
      <td>been</td>
    </tr>
    <tr>
      <th>6</th>
      <td>my</td>
      <td>PRON</td>
      <td>poss</td>
      <td>station</td>
    </tr>
    <tr>
      <th>7</th>
      <td>own</td>
      <td>ADJ</td>
      <td>amod</td>
      <td>station</td>
    </tr>
    <tr>
      <th>8</th>
      <td>station</td>
      <td>NOUN</td>
      <td>pobj</td>
      <td>of</td>
    </tr>
    <tr>
      <th>9</th>
      <td>!</td>
      <td>PUNCT</td>
      <td>punct</td>
      <td>wish</td>
    </tr>
    <tr>
      <th>10</th>
      <td>\n</td>
      <td>SPACE</td>
      <td></td>
      <td>!</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spacy</span> <span class="kn">import</span> <span class="n">displacy</span>
<span class="n">displacy</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">6751</span><span class="p">],</span> <span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;dep&#39;</span><span class="p">)</span>
</pre></div>


<p>Here's what the visualizer would render for us.
<img alt="" src="images/displacy.png"></p>
<p>While the code block mentioned above is enough to render displacy in jupyter notebook, we need to use displacy.serve for other cases.</p>
<h4>Matcher</h4>
<p>So if we wanted to extract every word group that consisted of a noun following an adjective, how would we do that?</p>
<p>We can use Rule based matching to accomplish this.</p>
<div class="highlight"><pre><span></span><span class="n">sentences</span><span class="p">[</span><span class="mi">6751</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>“‘Jephro,’ said she, ‘there is an impertinent fellow upon the road
there who stares up at Miss Hunter.’
</pre></div>


<p>Import matcher.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spacy.matcher</span> <span class="kn">import</span> <span class="n">Matcher</span>
</pre></div>


<p>Instantiate the matcher with shared vocab of the doc.</p>
<div class="highlight"><pre><span></span><span class="n">matcher</span> <span class="o">=</span> <span class="n">Matcher</span><span class="p">(</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
</pre></div>


<p>Create a custom pattern and add it to the matcher.</p>
<div class="highlight"><pre><span></span><span class="n">pattern</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;POS&#39;</span><span class="p">:</span> <span class="s1">&#39;ADJ&#39;</span><span class="p">},</span>
           <span class="p">{</span><span class="s1">&#39;POS&#39;</span><span class="p">:</span> <span class="s1">&#39;NOUN&#39;</span><span class="p">,</span> <span class="s1">&#39;OP&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">}]</span>
<span class="n">matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;CUSTOM_PATTERN&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
</pre></div>


<p>note: "OP" can have one of four values:
- '!' for 0 times
- '?' for 0 or 1 time
- '+' for 1 or more times
- '*' for 0 or more times</p>
<p>We can add pattern to the matcher as well thorugh matcher.add()</p>
<div class="highlight"><pre><span></span><span class="n">matches</span> <span class="o">=</span> <span class="n">matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>3202
</pre></div>


<p>We can access the matched spans through loops.</p>
<div class="highlight"><pre><span></span><span class="n">match_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span> <span class="k">for</span> <span class="n">match_id</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">]</span>
<span class="n">match_list</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">105</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>[other purposes, private note, own seal, little problem, serious one]
</pre></div>


<p>There's a lot more we can do with spacy, it is really well <a href="https://spacy.io/usage/spacy-101">documented</a> and easy to pick up. So if you're looking to do some more NLP alongside what <a href="https://www.nltk.org/">nltk</a> has to offer, check out spacy!</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Blog 3 - Intro to Naural Language Processing with spaCy&amp;url=https://nawarani.github.io/blog/blog-3.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://nawarani.github.io/blog/blog-3.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://nawarani.github.io/blog/blog-3.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>


                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://nawarani.github.io/blog/theme/js/script.js"></script>

</body>
</html>
